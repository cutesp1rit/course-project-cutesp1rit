# NFR — Таблица требований безопасности

| ID     | Название                         | Описание                                              | Метрика/Порог                                           | Проверка (чем/где)                                        | Компонент | Приоритет |
|--------|----------------------------------|-------------------------------------------------------|---------------------------------------------------------|-----------------------------------------------------------|-----------|-----------|
| NFR-01 | Нормализация ошибок API          | Единый JSON-формат ошибок (envelope)                  | 100% эндпойнтов                                           | Контракт-тесты (`tests/test_errors`)                      | api       | Medium    |
| NFR-02 | Безопасные заголовки по умолчанию| X-CTO, XFO, Referrer-Policy, X-XSS-Protection         | Заголовки на 100% ответов                                 | Контракт-тесты (`tests/test_errors`)                      | api       | Medium    |
| NFR-03 | Ограничение размера запроса      | Максимальный размер тела запроса                      | ≤ 1 MB для всех POST/PUT/PATCH                           | Конфиг/мидлварь + e2e                                     | api       | Medium    |
| NFR-04 | Уязвимости зависимостей          | Срок устранения High/Critical                         | ≤ 7 дней                                                 | CI-отчёт SCA/SBOM                                         | build     | High      |
| NFR-05 | Доступность health                | Доступность сервиса по `/health`                      | Uptime ≥ 99.5% в месяц                                   | Мониторинг/алёртинг                                      | ops       | High      |
| NFR-06 | Производительность GET /decks    | p95 при стабильной нагрузке                           | p95 ≤ 150 ms при 20 RPS (stage)                          | Нагрузочный тест (k6/locust)                             | api       | Medium    |
| NFR-07 | Маскирование PII в логах/ошибках | Исключать персональные данные из ошибок и логов       | 0 утечек PII в error/trace                               | Лог-парсер/регулярки в CI                                | api       | High      |
| NFR-08 | Rate limiting                     | Базовое ограждение от бурстов                         | ≤ 60 req/min на IP для публичных эндпойнтов              | e2e/интеграционные тесты                                 | edge      | Medium    |
